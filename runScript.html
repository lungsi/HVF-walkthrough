<!DOCTYPE html>

<html>

   <head>
      <meta name="description"
	     content="Quick Dive Into HBP Validation Framework Platform (HVF)." />
      <title>Dive into HVF Platform</title>
	  <link rel="stylesheet" href="validation_guidebook.css" />
   </head>

   <body onload="javascript:clearCurrentLink()">
      <div id="BodyContainer">
	     <!-- Header -->
	     <div>
		    <!-- <a href="xxxxx"><img src="xxxxx" alt="xxxxx" class="logo" /></a> -->
			<!-- Subject Title -->
		    <div id="SubjHeading">Quick Dive Into HBP Validation Framework Platform (HVF)</div>
			<br style="clear: both;" />
		 </div>
		 <!-- Menu Panel -->
	     <div id="MenuBox">
	        <a href="start.html">Home</a><br />
			<b>Steps</b><br />
			&#x2219;&nbsp;<a href="getModel.html">Choosing and Loading a Model.</a><br />
			&#x2219;&nbsp;<a href="getTest.html">Choosing and Loading a Test.</a><br />
                        &#x2219;&nbsp;<a href="runTestonModel.html">Running the Desired Validation Test On the Chosen Model.</a><br />
                        &#x2219;&nbsp;<a href="storeData.html">Store the Data of the Results.</a><br />
                        &#x2219;&nbsp;<a href="registerData.html">Registering Data into HVF Database.</a><br />
                        &#x2219;&nbsp;<a href="runScript.html">All the above from a python script.</a><br />
	     </div>
	     <!-- Main Content -->
	     <div id="ContentBox">
		    <p>
	           <h1>All the Preceeding Steps in a Script.</h1>
            </p>
			<p>
			   <div class="Figs" onclick="enlargeImage('1')">
				   <img src="imgs/writeScript.gif" alt="Write .py script"  class="FloatRight" />
			   </div>
			</p>
            <p>
			   <h2>Purpose</h2>
			</p>
			<p>
			   Run the desired validation on the chosen model from a script.
			</p>
			<p>&nbsp;</p>
			<p>
			   <h2>How to.</h2>
			</p>
			<p>
			   There are various ways of writing a script. Here is one version of a python script.
			</p>
			<p>
			   <strong>
			   <code>import argparse</code><br />
			   <code>import inspect</code><br />
			   <code>import models</code><br />
			   <code>from hbp_validation_framework import ValidationTestLibrary from hbp_validation_framework.datastores import CollabDataStore</code><br />
			   <code>#</code><br />
			   <code># Parses command line arguments</code><br />
			   <code>parser = argparse.ArgumentParser("Process model to be validated against the URI of the v-test.")</code><br />
			   <code>parser.add_argument ( "--modelName", help="A model name from hippocampus_CA1_pyramidal", choices= [m[0] for m in inspect.getmembers(models, inspect.isclass) if m[1].__module__ == 'models'])</code><br />
			   <code>parser.add_argument("--testURI", help="local path to the v-test")</code><br />
			   <code>parser.add_argument("--userName", default="lungsi", help="Give a username (default: lungsi)") parser.add_argument("--collabID", default="1655", help="The number of the collab (default: 1655)")</code><br />
			   <code>parser.add_argument("--folderName", default="VUC_modelName_testName_results", help="Give the folder name (default: VUC_modelName_testName_results)")</code><br />
			   <code>args = parser.parse_args()</code><br />
			   <code>#</code><br />
			   <code># Load the model</code><br />
			   <code>model = getattr(models, args.modelName)()</code><br />
			   <code>#</code><br />
			   <code># Load the test</code><br />
			   <code>desired_test_uri = args.testURI test_library = ValidationTestLibrary(username = args.userName) test = test_library.get_validation_test(desired_test_uri, show_plot=True) score = test.judge(model, deep_error=True)</code><br />
			   <code>#</code><br />
			   <code># Store the results</code><br />
			   <code>collab_storage = CollabDataStore(username = args.userName, collab_id = args.collabID, base_folder = args.folderName)</code>
			   </strong>
			</p>
			<p>&nbsp;</p>
			<p>
			   If you are working from a terminal, to copy-paste the below code you first need to have a .py file (here runTests.py). One way to do this in jupyter notebook is
			</p>
			<p>
			   <strong><code>>> %%writefile runTests.py -a</code></strong>
			</p>
			<p>&nbsp;</p>
			<p>
			   To run this <code>runTests.py</code> script from the jupyter notebook you can use the help feature.
			</p>
			<p>
			   <strong><code>>> %run runTests.py -h</code></strong>
			</p>
			<p>
			   You can than run the depolarization block test on the chosen CA1_Bianchi model as shown below
			</p>
			<p>
			   <strong><code>>> %run runTests.py --modelName Bianchi --testURI https://valiation.brainsimulation.eu/tests/1</code></strong>
			</p>
                        <p>
                          <div class="Figs" onclick="enlargeImage('2')">
				   <img src="imgs/runScript.gif" alt="Run the .py script"  class="Half" />
			   </div>
                        </p>
			<p>&nbsp;</p>
		</div>
		<script type="text/javascript" src="clearlink_togglevisibility.js"></script>
		<noscript><p>Welcome, non-JavaScript-enabled browser.</p></noscript>
      </div>
   </body>
</html>
